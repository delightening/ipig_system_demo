-- ============================================
-- 遷移 037: 更新 CLIENT 角色名稱
-- 說明: 將 CLIENT 角色的名稱從「委託人」更新為「委託單位代表人（主管）」
-- ============================================

-- ============================================
-- 1. 更新 CLIENT 角色名稱
-- ============================================

UPDATE roles
SET 
    name = '委託單位代表人（主管）',
    updated_at = NOW()
WHERE code = 'CLIENT';

-- ============================================
-- 2. 驗證更新
-- ============================================

-- 確認更新成功（如果找不到記錄，查詢結果為空）
DO $$
DECLARE
    updated_count INTEGER;
BEGIN
    SELECT COUNT(*) INTO updated_count
    FROM roles
    WHERE code = 'CLIENT' AND name = '委託單位代表人（主管）';
    
    IF updated_count = 0 THEN
        RAISE WARNING 'CLIENT 角色未找到或更新失敗';
    ELSE
        RAISE NOTICE 'CLIENT 角色名稱已成功更新為「委託單位代表人（主管）」';
    END IF;
END $$;

-- ============================================
-- 3. 說明與注意事項
-- ============================================

-- 已更新的角色：
-- 
-- CLIENT:
--   舊名稱: 委託人
--   新名稱: 委託單位代表人（主管）
--   代碼: CLIENT (不變)
--   權限: 不變
-- 
-- 注意：
--   1. 此變更僅影響角色顯示名稱，不影響角色代碼和權限設定
--   2. 現有用戶的角色分配不受影響
--   3. 前端 UI 也需要同步更新（已完成於 MyProjectsPage.tsx）
