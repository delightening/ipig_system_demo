# 豬博士 iPig 系統專案進度評估表

> **評估日期：** 2026-01-08  
> **規格版本：** v1.0  
> **評估標準：** ✅ 完成 | 🔶 部分完成 | 🔴 未開始 | ⏸️ 暫緩

---

## 📊 總體進度概覽

| 子系統 | 後端 API | 資料庫 | 前端 UI | 整體進度 |
|--------|----------|--------|---------|----------|
| **共用基礎架構** | 100% | 100% | 100% | **100%** |
| **AUP 審查系統** | 100% | 100% | 100% | **100%** |
| **進銷存管理系統** | 100% | 100% | 100% | **100%** |
| **實驗動物管理系統** | 100% | 100% | 100% | **100%** |
| **通知系統** | 100% | 100% | 100% | **100%** |

**整體專案進度：100% ✅**

---

## 1. 共用基礎架構

### 1.1 認證與授權

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 登入 (JWT) | ✅ | ✅ | ✅ | 完整實作 |
| 登出 | ✅ | ✅ | ✅ | |
| Token 刷新 | ✅ | ✅ | ✅ | |
| 忘記密碼 | ✅ | ✅ | ✅ | 含 Email 發送 |
| 重設密碼 | ✅ | ✅ | ✅ | Token 驗證 |
| 修改自己密碼 | ✅ | ✅ | ✅ | MainLayout 內對話框 |
| 首次登入強制變更密碼 | ✅ | ✅ | ✅ | ForceChangePasswordPage |
| 密碼強度檢查 | ✅ | ✅ | ✅ | 前端即時驗證 |

### 1.2 使用者管理

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 使用者列表 | ✅ | ✅ | ✅ | UsersPage |
| 建立使用者（私域註冊） | ✅ | ✅ | ✅ | 含 Email 通知 |
| 編輯使用者 | ✅ | ✅ | ✅ | |
| 停用/啟用帳號 | ✅ | ✅ | ✅ | |
| 重設密碼 | ✅ | ✅ | ✅ | 管理員重設 |
| 指派角色 | ✅ | ✅ | ✅ | |

### 1.3 角色權限管理

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 角色列表 | ✅ | ✅ | ✅ | RolesPage |
| 建立角色 | ✅ | ✅ | ✅ | |
| 編輯角色 | ✅ | ✅ | ✅ | |
| 角色權限指派 | ✅ | ✅ | ✅ | |
| 權限列表 | ✅ | ✅ | ✅ | |
| RBAC 中間件 | ✅ | ✅ | ✅ | 後端強制檢查 |

### 1.4 Email 服務

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| Gmail SMTP 整合 | ✅ | - | ✅ | lettre 套件 |
| 帳號開通通知信 | ✅ | - | ✅ | HTML + 純文字 |
| 密碼重設通知信 | ✅ | - | ✅ | 含重設連結 |
| 密碼變更成功通知 | ✅ | - | ✅ | |

### 1.5 稽核紀錄

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 稽核紀錄寫入 | ✅ | - | ✅ | 自動記錄 |
| 稽核紀錄查詢 | ✅ | ✅ | ✅ | AuditLogsPage |
| 篩選功能 | ✅ | ✅ | ✅ | |

---

## 2. AUP 提交與審查系統

### 2.1 計畫書管理

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 計畫書列表 | ✅ | ✅ | ✅ | ProtocolsPage |
| 建立計畫書（草稿） | ✅ | ✅ | ✅ | ProtocolEditPage |
| 編輯計畫書 | ✅ | ✅ | ✅ | |
| 檢視計畫書 | ✅ | ✅ | ✅ | ProtocolDetailPage |
| 提交計畫書 | ✅ | ✅ | ✅ | |
| 計畫書狀態機 | ✅ | ✅ | ✅ | 12 種狀態 |
| 狀態變更 | ✅ | ✅ | ✅ | 依角色權限 |
| 版本控管 | ✅ | ✅ | ✅ | 含版本內容檢視對話框 |
| 狀態歷程 | ✅ | ✅ | ✅ | 時間軸 UI |
| 草稿刪除（軟刪除） | ✅ | ✅ | ✅ | DELETED 狀態 |

### 2.2 審查流程

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 指派審查人員 | ✅ | ✅ | ✅ | 審查人員 Tab + 指派對話框 |
| 審查意見列表 | ✅ | ✅ | ✅ | 含審查者資訊 |
| 新增審查意見 | ✅ | ✅ | ✅ | 新增意見對話框 |
| 解決審查意見 | ✅ | ✅ | ✅ | 標記已解決按鈕 |
| 核准/否決 | ✅ | ✅ | ✅ | |

### 2.3 附件管理

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 上傳附件 | ✅ | ✅ | ✅ | FileService + 多類型支援 |
| 下載附件 | ✅ | ✅ | ✅ | 安全路徑檢查 |
| 附件列表 | ✅ | ✅ | ✅ | 附件 Tab 完整 |
| 刪除附件 | ✅ | ✅ | ✅ | 權限控制 |

### 2.4 我的計劃（外部使用者）

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 我的計劃列表 | ✅ | ✅ | ✅ | MyProjectsPage |
| 計劃詳情 | ✅ | ✅ | ✅ | MyProjectDetailPage |
| 申請表 Tab | ✅ | ✅ | ✅ | 完整顯示 |
| 豬隻紀錄 Tab | ✅ | ✅ | ✅ | |

---

## 3. 進銷存管理系統

### 3.1 基礎資料

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 倉庫管理 | ✅ | ✅ | ✅ | WarehousesPage |
| 產品管理 | ✅ | ✅ | ✅ | ProductsPage |
| 產品新增 | ✅ | ✅ | ✅ | CreateProductPage |
| 產品詳情 | ✅ | ✅ | ✅ | ProductDetailPage |
| SKU 生成 | ✅ | ✅ | ✅ | 互動式生成 |
| 供應商/客戶管理 | ✅ | ✅ | ✅ | PartnersPage |
| 產品類別 | ✅ | ✅ | ✅ | |

### 3.2 採購流程

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 採購單（PO） | ✅ | ✅ | ✅ | DocumentsPage |
| 採購入庫（GRN） | ✅ | ✅ | ✅ | |
| 採購退貨（PR） | ✅ | ✅ | ✅ | |
| 單據編輯 | ✅ | ✅ | ✅ | DocumentEditPage |
| 單據詳情 | ✅ | ✅ | ✅ | DocumentDetailPage |
| 送審/核准 | ✅ | ✅ | ✅ | |

### 3.3 銷售流程

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 銷售單（SO） | ✅ | ✅ | ✅ | |
| 銷售出庫（DO） | ✅ | ✅ | ✅ | |
| 銷售退貨（SR） | ✅ | ✅ | ✅ | |

### 3.4 倉儲作業

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 庫存查詢 | ✅ | ✅ | ✅ | InventoryPage |
| 庫存流水 | ✅ | ✅ | ✅ | StockLedgerPage |
| 調撥單（TR） | ✅ | ✅ | ✅ | |
| 盤點單（STK） | ✅ | ✅ | ✅ | |
| 調整單（ADJ） | ✅ | ✅ | ✅ | |
| 低庫存提醒 | ✅ | ✅ | ✅ | |

### 3.5 報表

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 庫存現況報表 | ✅ | ✅ | ✅ | StockOnHandReportPage |
| 庫存流水報表 | ✅ | ✅ | ✅ | StockLedgerReportPage |
| 採購明細報表 | ✅ | ✅ | ✅ | PurchaseLinesReportPage |
| 銷售明細報表 | ✅ | ✅ | ✅ | SalesLinesReportPage |
| 成本摘要報表 | ✅ | ✅ | ✅ | CostSummaryReportPage |
| CSV 匯出 | ✅ | ✅ | ✅ | |

---

## 4. 實驗動物管理系統

### 4.1 豬隻管理

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 豬隻列表 | ✅ | ✅ | ✅ | PigsPage |
| 依狀態篩選 | ✅ | ✅ | ✅ | Tab 切換 |
| 依欄位分組檢視 | ✅ | ✅ | ✅ | 分組卡片視圖 |
| 新增豬隻 | ✅ | ✅ | ✅ | |
| 編輯豬隻 | ✅ | ✅ | ✅ | PigEditPage |
| 豬隻詳情（7 Tab） | ✅ | ✅ | ✅ | PigDetailPage |
| 批次分配至計劃 | ✅ | ✅ | ✅ | |
| 批次進入實驗 | ✅ | ✅ | ✅ | |
| 匯入基本資料 | ✅ | ✅ | ✅ | ImportDialog |
| 匯入體重 | ✅ | ✅ | ✅ | ImportDialog |

### 4.2 豬隻紀錄 - 觀察試驗紀錄

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 紀錄列表 | ✅ | ✅ | ✅ | |
| 新增紀錄 | ✅ | ✅ | ✅ | ObservationFormDialog 完整表單 |
| 編輯紀錄 | ✅ | ✅ | ✅ | |
| 刪除紀錄（軟刪除） | ✅ | ✅ | ✅ | |
| 複製紀錄 | ✅ | ✅ | ✅ | 含確認對話框 |
| 版本歷史 | ✅ | ✅ | ✅ | VersionHistoryDialog |
| 獸醫師已讀標記 | ✅ | ✅ | ✅ | |
| 獸醫師建議 | ✅ | ✅ | ✅ | VetRecommendationDialog |

### 4.3 豬隻紀錄 - 手術紀錄

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 紀錄列表 | ✅ | ✅ | ✅ | |
| 新增紀錄 | ✅ | ✅ | ✅ | SurgeryFormDialog 完整表單 |
| 編輯紀錄 | ✅ | ✅ | ✅ | |
| 刪除紀錄 | ✅ | ✅ | ✅ | |
| 複製紀錄 | ✅ | ✅ | ✅ | 含確認對話框 |
| 版本歷史 | ✅ | ✅ | ✅ | VersionHistoryDialog |
| 生理數值記錄 | ✅ | ✅ | ✅ | Repeater 多筆輸入 |
| 獸醫師建議 | ✅ | ✅ | ✅ | VetRecommendationDialog |

### 4.4 豬隻紀錄 - 其他紀錄

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 體重紀錄 CRUD | ✅ | ✅ | ✅ | |
| 疫苗/驅蟲紀錄 CRUD | ✅ | ✅ | ✅ | |
| 犧牲/採樣紀錄 | ✅ | ✅ | ✅ | |
| 病理組織報告 | ✅ | ✅ | ✅ | 含上傳功能 |

### 4.5 資料匯出

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 單一豬隻病歷匯出 | ✅ | ✅ | ✅ | ExportDialog |
| 計劃病歷批次匯出 | ✅ | ✅ | ✅ | ExportDialog |
| 觀察試驗紀錄匯出 | ✅ | ✅ | ✅ | |
| 手術紀錄匯出 | ✅ | ✅ | ✅ | |

### 4.6 豬隻來源管理

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 來源列表 | ✅ | ✅ | ✅ | PigSourcesPage |
| 新增來源 | ✅ | ✅ | ✅ | |
| 編輯來源 | ✅ | ✅ | ✅ | |
| 刪除來源 | ✅ | ✅ | ✅ | |

---

## 5. 通知系統

### 5.1 Email 通知

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 帳號開通通知 | ✅ | - | ✅ | HTML + 純文字格式 |
| 密碼重設通知 | ✅ | - | ✅ | 含重設連結 |
| 密碼變更通知 | ✅ | - | ✅ | |
| 計畫提交通知 | ✅ | - | ✅ | 通知 IACUC_STAFF |
| 計畫狀態變更通知 | ✅ | - | ✅ | 通知 PI 及相關人員 |
| 審查指派通知 | ✅ | - | ✅ | 通知被指派的審查人員 |
| 獸醫師建議通知 | ✅ | - | ✅ | 通知 EXPERIMENT_STAFF |
| 低庫存提醒 | ✅ | - | ✅ | 排程 + 手動觸發 |
| 效期提醒 | ✅ | - | ✅ | 排程 + 手動觸發 |

### 5.2 站內通知

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 通知資料表 | ✅ | - | ✅ | migration 005 新增欄位 |
| 通知列表 API | ✅ | - | ✅ | handler 完整 |
| 未讀數量 | ✅ | ✅ | ✅ | Header 顯示 |
| 標記已讀 | ✅ | ✅ | ✅ | |
| 標記全部已讀 | ✅ | ✅ | ✅ | |
| Header 通知圖示 | - | ✅ | ✅ | MainLayout |
| 通知下拉選單 | - | ✅ | ✅ | 含點擊導航 |
| 通知設定 | ✅ | ✅ | ✅ | SettingsPage 整合 |

### 5.3 排程任務

| 功能 | 後端 | 前端 | 狀態 | 備註 |
|-----|:---:|:---:|:---:|------|
| 低庫存每日檢查 | ✅ | - | ✅ | 每日 08:00 執行 |
| 效期每日檢查 | ✅ | - | ✅ | 每日 08:00 執行 |
| 過期通知清理 | ✅ | - | ✅ | 每週日 03:00 執行 |
| 手動觸發檢查 | ✅ | - | ✅ | Admin API 可手動觸發 |

---

## 6. 資料庫 Schema 完成度

| Migration | 內容 | 狀態 |
|-----------|------|:---:|
| 001_initial_schema.sql | ERP 基礎表、使用者權限 | ✅ |
| 002_extend_schema.sql | AUP 系統、動物管理系統表 | ✅ |
| 003_frontend_requirements.sql | 通知系統、排程報表、views | ✅ |
| 004_pig_frontend_requirements.sql | 動物管理前端需求擴充 | ✅ |
| 005_notification_types.sql | 通知類型擴展、日誌表、清理函數 | ✅ |
| 006_attachments.sql | 附件管理表、索引 | ✅ |

---

## 7. 待辦事項優先順序

### ✅ 已完成

1. ~~**檔案上傳後端實作**~~ - 檔案儲存服務已完成
2. ~~**通知偏好設定前端**~~ - SettingsPage 整合完成

### 🟢 低優先（可延後）

1. **AUP 版本比較** - 版本差異顯示
2. **通知中心頁面** - 完整通知列表頁面

---

## 8. 技術債與已知問題

| 項目 | 描述 | 優先級 |
|------|------|:------:|
| ~~檔案上傳實際後端~~ | ✅ 已完成 - FileService + handlers | - |
| 表單驗證統一 | 使用 Zod schema 統一驗證 | 低 |
| 錯誤處理統一 | 統一錯誤顯示與處理方式 | 中 |
| Loading 狀態統一 | 骨架屏與 Loading 指示器 | 低 |
| 響應式設計 | 行動裝置適配 | 低 |

---

## 9. 版本規劃

### v1.0 MVP（完成度：100% ✅）

- [x] 共用基礎架構
- [x] 進銷存核心功能
- [x] 實驗動物管理完整表單
- [x] 資料匯出功能
- [x] 站內通知系統
- [x] 複製紀錄功能
- [x] 版本歷史檢視
- [x] 獸醫師建議功能
- [x] AUP 審查流程完整 UI（審查意見、指派、附件）
- [x] 檔案上傳後端服務
- [x] 通知偏好設定前端

### v1.1（後續版本）

- [x] 排程任務（已完成）
- [x] 完整 Email 通知（已完成）
- [x] 檔案上傳後端服務（已完成）
- [x] 通知偏好設定前端（已完成）

### v2.0（遠程規劃）

- [ ] 行動端適配
- [ ] PDF 報表生成
- [ ] 進階成本法（FIFO）
- [ ] 條碼掃描功能

---

## 10. 結論

豬博士 iPig 系統整體完成度 **100%** ✅，所有子系統均已完成：

1. **進銷存管理系統** 完成度 100%，已可投入使用
2. **共用基礎架構** 完整 100%，認證授權、Email 服務均已就緒
3. **AUP 審查系統** 完整 100%，審查流程 UI 完整，附件上傳已完成
4. **實驗動物管理系統** 完整 100%，所有功能均已實作
5. **通知系統** 完整 100%，排程任務、Email 通知、偏好設定均已完成

**本次更新完成內容（v1.0 收尾）：**
1. ✅ 檔案上傳後端服務 - FileService 支援多類型檔案
2. ✅ 附件 Handler - 上傳/下載/刪除 API 端點
3. ✅ 附件資料庫遷移 - 006_attachments.sql
4. ✅ 通知偏好設定前端 - SettingsPage 整合完整 UI
5. ✅ 路由更新 - 檔案上傳相關 API 端點

**v1.0 已完成，系統可正式上線！**

**v2.0 規劃功能：**
1. 行動端適配
2. PDF 報表生成
3. 進階成本法（FIFO）
4. 條碼掃描功能

---

*本報告由系統自動產生，如有疑問請聯繫開發團隊。*
